<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Storage Modes of MS Data Objects • MsIO</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Storage Modes of MS Data Objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MsIO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MsIO.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MsIO/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Storage Modes of MS Data Objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsIO/blob/main/vignettes/MsIO.Rmd" class="external-link"><code>vignettes/MsIO.Rmd</code></a></small>
      <div class="d-none name"><code>MsIO.Rmd</code></div>
    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.20/MsIO" class="external-link">MsIO</a></em><br><strong>Authors</strong>: Johannes Rainer [aut, cre] (<a href="https://orcid.org/0000-0002-6977-7147" class="external-link uri">https://orcid.org/0000-0002-6977-7147</a>), Philippine
Louail [aut] (<a href="https://orcid.org/0009-0007-5429-6846" class="external-link uri">https://orcid.org/0009-0007-5429-6846</a>), Laurent Gatto
[ctb] (<a href="https://orcid.org/0000-0002-1520-2268" class="external-link uri">https://orcid.org/0000-0002-1520-2268</a>)<br><strong>Compiled</strong>: Thu Sep 5 10:09:12 2024</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Data objects in R can be serialized to disk in R’s <em>Rds</em>
format using the base R <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code> function and re-imported
using the <code><a href="https://rdrr.io/r/base/load.html" class="external-link">load()</a></code> function. This R-specific binary data
format can however not be used or read by other programming languages
preventing thus the exchange of R data objects between software or
programming languages. The <em>MsIO</em> package provides functionality
to export and import mass spectrometry data objects in various storage
formats aiming to facilitate data exchange between software. This
includes, among other formats, also storage of data objects using
Bioconductor’s <em><a href="https://bioconductor.org/packages/3.20/alabaster.base" class="external-link">alabaster.base</a></em>
package.</p>
<p>For export or import of MS data objects, the
<code><a href="../reference/saveMsObject.html">saveMsObject()</a></code> and <code><a href="../reference/saveMsObject.html">readMsObject()</a></code> functions
can be used. For <code><a href="../reference/saveMsObject.html">saveMsObject()</a></code>, the first parameter is the
MS data object that should be stored, for <code><a href="../reference/saveMsObject.html">readMsObject()</a></code> it
defines type of MS object that should be restored (returned). The second
parameter <code>param</code> defines and configures the storage format
of the MS data. The currently supported formats and the respective
parameter objects are:</p>
<ul>
<li>
<code>PlainTextParam</code>: storage of data in plain text file
format.</li>
<li>
<code>AlabasterParam</code>: storage of MS data using Bioconductor’s
<em><a href="https://bioconductor.org/packages/3.20/alabaster.base" class="external-link">alabaster.base</a></em>
framework based files in HDF5 and JSON format.</li>
</ul>
<p>These storage formats are described in more details in the following
sections.</p>
<p>An example use of these functions and parameters:
<code>saveMsObject(x, param = PlainTextParam(storage_path))</code> to
store an MS data object assigned to a variable <code>x</code> to a
directory <code>storage_path</code> using the plain text file format. To
restore the data (assuming <code>x</code> was an instance of a
<code>MsExperiment</code> class):
<code>readMsObject(MsExperiment(), param = PlainTextParam(storage_path))</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed with the <em>BiocManager</em> package.
To install <em>BiocManager</em> use
<code>install.packages("BiocManager")</code> and, after that,
<code>BiocManager::install("RforMassSpectrometry/MsIO")</code> to
install this package.</p>
<p>For import or export of MS data objects installation of additional
Bioconductor packages might be needed:</p>
<ul>
<li>
<em><a href="https://bioconductor.org/packages/3.20/Spectra" class="external-link">Spectra</a></em>
(with <code>BiocManager::install("Spectra")</code>) for import or export
of <code>Spectra</code> or <code>MsBackendMzR</code> objects.</li>
<li>
<em><a href="https://bioconductor.org/packages/3.20/MsExperiment" class="external-link">MsExperiment</a></em>
(with <code>BiocManager::install("MsExperiment")</code>) for import or
export of <code>MsExperiment</code> objects.</li>
<li>
<em><a href="https://bioconductor.org/packages/3.20/xcms" class="external-link">xcms</a></em> (with
<code>BiocManager::install("xcms")</code>) for import or export of
<code>XcmsExperiment</code> objects (result objects of
<em>xcms</em>-based preprocessing).</li>
</ul>
</div>
<div class="section level2">
<h2 id="plain-text-file-format">Plain text file format<a class="anchor" aria-label="anchor" href="#plain-text-file-format"></a>
</h2>
<p>Storage of MS data objects in <em>plain</em> text format aims to
support an easy exchange of data, and in particular analysis results,
with external software, such as <a href="https://systemsomicslab.github.io/compms/msdial/main.html" class="external-link">MS-DIAL</a>
or <a href="http://mzmine.github.io/download.html" class="external-link">mzmine3</a>. In most
cases, the data is stored as tabulator delimited text files simplifying
the use of the data and results across multiple programming languages,
or their import into spreadsheet applications. MS data objects stored in
plain text format can also be fully re-imported into R providing thus an
alternative, and more flexible, object serialization approach than the R
internal <em>Rds</em>/<em>RData</em> format.</p>
<p>Below we create a MS data object (<code>MsExperiment</code>)
representing the data from two raw MS data files and assign sample
annotation information to these data files.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsIO" class="external-link">MsIO</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"TripleTOF-SWATH"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>,</span>
<span>           full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span></span>
<span>    <span class="va">fls</span>,</span>
<span>    sampleData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pestmix1 DDA"</span>, <span class="st">"Pestmix SWATH"</span><span class="op">)</span>,</span>
<span>                            mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DDA"</span>, <span class="st">"SWATH"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mse</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class MsExperiment </span></span>
<span><span class="co">##  Spectra: MS1 (5626) MS2 (10975) </span></span>
<span><span class="co">##  Experiment data: 2 sample(s)</span></span>
<span><span class="co">##  Sample data links:</span></span>
<span><span class="co">##   - spectra: 2 sample(s) to 16601 element(s).</span></span></code></pre>
<p>We can export this data object to plain text files using
<em>MsIO</em>’s <code><a href="../reference/saveMsObject.html">saveMsObject()</a></code> function in combination with
the <code>PlainTextParam</code> parameter object. The path to the
directory to which the data should be stored can be defined with the
<code>path</code> parameter of <code>PlainTextParam</code>. With the
call below we store the MS data object to a temporary directory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"ms_experiment_export"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/saveMsObject.html">saveMsObject</a></span><span class="op">(</span><span class="va">mse</span>, <span class="fu"><a href="../reference/PlainTextParam.html">PlainTextParam</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The data was exported to a set of text files that we list below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ms_backend_data.txt"                        </span></span>
<span><span class="co">## [2] "ms_experiment_link_mcols.txt"               </span></span>
<span><span class="co">## [3] "ms_experiment_sample_data_links_spectra.txt"</span></span>
<span><span class="co">## [4] "ms_experiment_sample_data.txt"              </span></span>
<span><span class="co">## [5] "spectra_processing_queue.json"              </span></span>
<span><span class="co">## [6] "spectra_slots.txt"</span></span></code></pre>
<p>Each text file contains information about one particular
<em>slot</em> of the MS data object. See the
<code><a href="../reference/PlainTextParam.html">?PlainTextParam</a></code> help for a description of the files and
their respective formats. We can restore the MS data object again using
the <code><a href="../reference/saveMsObject.html">readMsObject()</a></code> function, specifying the type of object
we want to restore (and which was stored to the respective directory)
with the first parameter of the function and the data storage format
with the second. In our example we use <code><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment()</a></code> as
first parameter and <code>PlainTextParam</code> as second. The MS data
of our <code>MsExperiment</code> data object was represented by a
<code>Spectra</code> object, thus, to import the data we need in
addition to load the <em><a href="https://bioconductor.org/packages/3.20/Spectra" class="external-link">Spectra</a></em>
package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Spectra" class="external-link">Spectra</a></span><span class="op">)</span></span>
<span><span class="va">mse_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saveMsObject.html">readMsObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/PlainTextParam.html">PlainTextParam</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mse_in</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class MsExperiment </span></span>
<span><span class="co">##  Spectra: MS1 (5626) MS2 (10975) </span></span>
<span><span class="co">##  Experiment data: 2 sample(s)</span></span>
<span><span class="co">##  Sample data links:</span></span>
<span><span class="co">##   - spectra: 2 sample(s) to 16601 element(s).</span></span></code></pre>
<p>Note that at present <em>MsIO</em> does <strong>not</strong> support
storage of the full MS data (i.e. the individual mass peaks’
<em>m/z</em> and intensity values) to plain text file. <em>MsIO</em>
supports storage of <em>on-disk</em> data objects/representations (such
as the <code>MsBackendMzR</code> object) to plain text formats. The
<code>Spectra</code> object that is used to represent the MS data of our
example <code>MsExperiment</code> object uses a
<code>MsBackendMzR</code> backend and thus we were able to export and
import its data. Due to its on-disk data mode, this type of backend
retrieves the MS data on-the-fly from the original data files and hence
we only need to store the MS metadata and the location of the original
data files. Thus, also with the restored MS data object we have full
access to the MS data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectra</a></span><span class="op">(</span><span class="va">mse_in</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NumericList of length 6</span></span>
<span><span class="co">## [[1]] 0.0307632219046354 0.163443520665169 ... 0.507792055606842</span></span>
<span><span class="co">## [[2]] 0.124385602772236 0.306980639696121 ... 0.752154946327209</span></span>
<span><span class="co">## [[3]] 0.140656530857086 0.194816112518311 ... 0.455461025238037</span></span>
<span><span class="co">## [[4]] 0.0389336571097374 0.357547700405121 ... 0.478326231241226</span></span>
<span><span class="co">## [[5]] 0.124386593699455 0.054143700748682 ... 0.251276850700378</span></span>
<span><span class="co">## [[6]] 0.0940475389361382 0.247442871332169 ... 0.10762557387352</span></span></code></pre>
<p>However, ff the location of the original MS data files was changed
(e.g. if the files or the stored object was moved to a different
location or file system), the new location of these files would be
needed to be specified with parameter <code>spectraPath</code>
(e.g. <code>readMsObject(MsExperiment(), PlainTextParam(d), spectraPath = &lt;path to new location&gt;)</code>).</p>
<p>Generally, <code>saveMsData()</code> stores the MS data objects in a
modular way, i.e. the content of each component or slot is exported to
its own data file. The storage directory of our example
<code>MsExperiment</code> contains thus multiple data files:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ms_backend_data.txt"                        </span></span>
<span><span class="co">## [2] "ms_experiment_link_mcols.txt"               </span></span>
<span><span class="co">## [3] "ms_experiment_sample_data_links_spectra.txt"</span></span>
<span><span class="co">## [4] "ms_experiment_sample_data.txt"              </span></span>
<span><span class="co">## [5] "spectra_processing_queue.json"              </span></span>
<span><span class="co">## [6] "spectra_slots.txt"</span></span></code></pre>
<p>This modularity allows also to load only parts of the original data.
We can for example also load only the <code>Spectra</code> object
representing the MS experiment’s MS data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saveMsObject.html">readMsObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/PlainTextParam.html">PlainTextParam</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s</span></span></code></pre></div>
<pre><code><span><span class="co">## MSn data (Spectra) with 16601 spectra in a MsBackendMzR backend:</span></span>
<span><span class="co">##         msLevel     rtime scanIndex</span></span>
<span><span class="co">##       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span></span>
<span><span class="co">## 1             1     0.231         1</span></span>
<span><span class="co">## 2             1     0.351         2</span></span>
<span><span class="co">## 3             1     0.471         3</span></span>
<span><span class="co">## 4             1     0.591         4</span></span>
<span><span class="co">## 5             1     0.711         5</span></span>
<span><span class="co">## ...         ...       ...       ...</span></span>
<span><span class="co">## 16597         2   899.527      8995</span></span>
<span><span class="co">## 16598         2   899.624      8996</span></span>
<span><span class="co">## 16599         2   899.721      8997</span></span>
<span><span class="co">## 16600         2   899.818      8998</span></span>
<span><span class="co">## 16601         2   899.915      8999</span></span>
<span><span class="co">##  ... 27 more variables/columns.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## file(s):</span></span>
<span><span class="co">## PestMix1_DDA.mzML</span></span>
<span><span class="co">## PestMix1_SWATH.mzML</span></span></code></pre>
<p>Or even only the <code>MsBackendMzR</code> that is used by the
<code>Spectra</code> object to represent the MS data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saveMsObject.html">readMsObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html" class="external-link">MsBackendMzR</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/PlainTextParam.html">PlainTextParam</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">be</span></span></code></pre></div>
<pre><code><span><span class="co">## MsBackendMzR with 16601 spectra</span></span>
<span><span class="co">##         msLevel     rtime scanIndex</span></span>
<span><span class="co">##       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span></span>
<span><span class="co">## 1             1     0.231         1</span></span>
<span><span class="co">## 2             1     0.351         2</span></span>
<span><span class="co">## 3             1     0.471         3</span></span>
<span><span class="co">## 4             1     0.591         4</span></span>
<span><span class="co">## 5             1     0.711         5</span></span>
<span><span class="co">## ...         ...       ...       ...</span></span>
<span><span class="co">## 16597         2   899.527      8995</span></span>
<span><span class="co">## 16598         2   899.624      8996</span></span>
<span><span class="co">## 16599         2   899.721      8997</span></span>
<span><span class="co">## 16600         2   899.818      8998</span></span>
<span><span class="co">## 16601         2   899.915      8999</span></span>
<span><span class="co">##  ... 27 more variables/columns.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## file(s):</span></span>
<span><span class="co">## PestMix1_DDA.mzML</span></span>
<span><span class="co">## PestMix1_SWATH.mzML</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="alabaster-based-formats">
<em>alabaster</em>-based formats<a class="anchor" aria-label="anchor" href="#alabaster-based-formats"></a>
</h2>
<p>The <a href="https://github.com/ArtifactDB/alabaster.base" class="external-link">alabaster
framework</a> and related Bioconductor package <em><a href="https://bioconductor.org/packages/3.20/alabaster.base" class="external-link">alabaster.base</a></em>
implements methods to save a variety of R/Bioconductor objects to
on-disk representations based on standard file formats like HDF5 and
JSON. This ensures that Bioconductor objects can be easily read from
other languages like Python and Javascript. With
<code>AlabasterParam</code>, <em>MsIO</em> supports export of MS data
objects into these storage formats. Below we export our example
<code>MsExperiment</code> to a storage directory using the alabaster
format.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"ms_experiment_export_alabaster"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/saveMsObject.html">saveMsObject</a></span><span class="op">(</span><span class="va">mse</span>, <span class="fu"><a href="../reference/AlabasterParam.html">AlabasterParam</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The contents of the storage folder is listed below:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">d</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "experiment_files/OBJECT"                       </span></span>
<span><span class="co">##  [2] "experiment_files/x/list_contents.json.gz"      </span></span>
<span><span class="co">##  [3] "experiment_files/x/OBJECT"                     </span></span>
<span><span class="co">##  [4] "metadata/list_contents.json.gz"                </span></span>
<span><span class="co">##  [5] "metadata/OBJECT"                               </span></span>
<span><span class="co">##  [6] "OBJECT"                                        </span></span>
<span><span class="co">##  [7] "other_data/list_contents.json.gz"              </span></span>
<span><span class="co">##  [8] "other_data/OBJECT"                             </span></span>
<span><span class="co">##  [9] "sample_data_links_mcols/basic_columns.h5"      </span></span>
<span><span class="co">## [10] "sample_data_links_mcols/OBJECT"                </span></span>
<span><span class="co">## [11] "sample_data_links/list_contents.json.gz"       </span></span>
<span><span class="co">## [12] "sample_data_links/OBJECT"                      </span></span>
<span><span class="co">## [13] "sample_data_links/other_contents/0/array.h5"   </span></span>
<span><span class="co">## [14] "sample_data_links/other_contents/0/OBJECT"     </span></span>
<span><span class="co">## [15] "sample_data/basic_columns.h5"                  </span></span>
<span><span class="co">## [16] "sample_data/OBJECT"                            </span></span>
<span><span class="co">## [17] "spectra/backend/OBJECT"                        </span></span>
<span><span class="co">## [18] "spectra/backend/peaks_variables/contents.h5"   </span></span>
<span><span class="co">## [19] "spectra/backend/peaks_variables/OBJECT"        </span></span>
<span><span class="co">## [20] "spectra/backend/spectra_data/basic_columns.h5" </span></span>
<span><span class="co">## [21] "spectra/backend/spectra_data/OBJECT"           </span></span>
<span><span class="co">## [22] "spectra/metadata/list_contents.json.gz"        </span></span>
<span><span class="co">## [23] "spectra/metadata/OBJECT"                       </span></span>
<span><span class="co">## [24] "spectra/OBJECT"                                </span></span>
<span><span class="co">## [25] "spectra/processing_chunk_size/contents.h5"     </span></span>
<span><span class="co">## [26] "spectra/processing_chunk_size/OBJECT"          </span></span>
<span><span class="co">## [27] "spectra/processing_queue_variables/contents.h5"</span></span>
<span><span class="co">## [28] "spectra/processing_queue_variables/OBJECT"     </span></span>
<span><span class="co">## [29] "spectra/processing/contents.h5"                </span></span>
<span><span class="co">## [30] "spectra/processing/OBJECT"                     </span></span>
<span><span class="co">## [31] "spectra/spectra_processing_queue.json"</span></span></code></pre>
<p>In contrast to the plain text format described in the previous
section, that stores all data files into a single directory, the
alabaster export is structured hierarchically into sub-folders by the MS
data object’s slots/components.</p>
<p>To restore the object we use the <code><a href="../reference/saveMsObject.html">readMsObject()</a></code> function
with an <code>AlabasterParam</code> parameter objects to define the used
data storage format.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mse_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saveMsObject.html">readMsObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/AlabasterParam.html">AlabasterParam</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mse_in</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class MsExperiment </span></span>
<span><span class="co">##  Spectra: MS1 (5626) MS2 (10975) </span></span>
<span><span class="co">##  Experiment data: 2 sample(s)</span></span>
<span><span class="co">##  Sample data links:</span></span>
<span><span class="co">##   - spectra: 2 sample(s) to 16601 element(s).</span></span></code></pre>
<p>Also for this format, we can load parts of the data separately. We
can load the MS data as a <code>Spectra</code> object from the
respective subfolder of the data storage directory:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saveMsObject.html">readMsObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/AlabasterParam.html">AlabasterParam</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"spectra"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s</span></span></code></pre></div>
<pre><code><span><span class="co">## MSn data (Spectra) with 16601 spectra in a MsBackendMzR backend:</span></span>
<span><span class="co">##         msLevel     rtime scanIndex</span></span>
<span><span class="co">##       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span></span>
<span><span class="co">## 1             1     0.231         1</span></span>
<span><span class="co">## 2             1     0.351         2</span></span>
<span><span class="co">## 3             1     0.471         3</span></span>
<span><span class="co">## 4             1     0.591         4</span></span>
<span><span class="co">## 5             1     0.711         5</span></span>
<span><span class="co">## ...         ...       ...       ...</span></span>
<span><span class="co">## 16597         2   899.527      8995</span></span>
<span><span class="co">## 16598         2   899.624      8996</span></span>
<span><span class="co">## 16599         2   899.721      8997</span></span>
<span><span class="co">## 16600         2   899.818      8998</span></span>
<span><span class="co">## 16601         2   899.915      8999</span></span>
<span><span class="co">##  ... 33 more variables/columns.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## file(s):</span></span>
<span><span class="co">## PestMix1_DDA.mzML</span></span>
<span><span class="co">## PestMix1_SWATH.mzML</span></span></code></pre>
<p>The import/export functionality is completely compatible with
Bioconductor’s alabaster framework and hence allows also to read the
whole, or parts of the data directly using alabaster’s
<code><a href="../reference/AlabasterParam.html">readObject()</a></code> method. The full <code>MsExperiment</code> is
restored importing the full directory (i.e. providing the path to the
directory containing the full export with the function’s
<code>path</code> parameter).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mse_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AlabasterParam.html">readObject</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span><span class="va">mse_in</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class MsExperiment </span></span>
<span><span class="co">##  Spectra: MS1 (5626) MS2 (10975) </span></span>
<span><span class="co">##  Experiment data: 2 sample(s)</span></span>
<span><span class="co">##  Sample data links:</span></span>
<span><span class="co">##   - spectra: 2 sample(s) to 16601 element(s).</span></span></code></pre>
<p>Alternatively, by providing a path to one of the MS object’s
components, it is possible to read only specific parts of the data.
Below we read the sample annotation information as a
<code>DataFrame</code> from the <em>sample_data</em> subfolder:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/AlabasterParam.html">readObject</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"sample_data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 2 rows and 3 columns</span></span>
<span><span class="co">##            name        mode spectraOrigin</span></span>
<span><span class="co">##     &lt;character&gt; &lt;character&gt;   &lt;character&gt;</span></span>
<span><span class="co">## 1 Pestmix1 D...         DDA /__w/_temp...</span></span>
<span><span class="co">## 2 Pestmix SW...       SWATH /__w/_temp...</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] Spectra_1.15.7      BiocParallel_1.39.0 S4Vectors_0.43.2   </span></span>
<span><span class="co">## [4] BiocGenerics_0.51.1 MsExperiment_1.7.0  ProtGenerics_1.37.1</span></span>
<span><span class="co">## [7] MsIO_0.0.4          BiocStyle_2.33.1   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tidyselect_1.2.1            dplyr_1.1.4                </span></span>
<span><span class="co">##  [3] fastmap_1.2.0               lazyeval_0.2.2             </span></span>
<span><span class="co">##  [5] digest_0.6.37               lifecycle_1.0.4            </span></span>
<span><span class="co">##  [7] cluster_2.1.6               alabaster.matrix_1.5.5     </span></span>
<span><span class="co">##  [9] alabaster.base_1.5.6        magrittr_2.0.3             </span></span>
<span><span class="co">## [11] compiler_4.4.1              rlang_1.1.4                </span></span>
<span><span class="co">## [13] sass_0.4.9                  tools_4.4.1                </span></span>
<span><span class="co">## [15] igraph_2.0.3                utf8_1.2.4                 </span></span>
<span><span class="co">## [17] yaml_2.3.10                 knitr_1.48                 </span></span>
<span><span class="co">## [19] S4Arrays_1.5.7              htmlwidgets_1.6.4          </span></span>
<span><span class="co">## [21] DelayedArray_0.31.11        plyr_1.8.9                 </span></span>
<span><span class="co">## [23] abind_1.4-5                 HDF5Array_1.33.6           </span></span>
<span><span class="co">## [25] purrr_1.0.2                 desc_1.4.3                 </span></span>
<span><span class="co">## [27] grid_4.4.1                  fansi_1.0.6                </span></span>
<span><span class="co">## [29] Rhdf5lib_1.27.0             MASS_7.3-61                </span></span>
<span><span class="co">## [31] MultiAssayExperiment_1.31.5 SummarizedExperiment_1.35.1</span></span>
<span><span class="co">## [33] cli_3.6.3                   mzR_2.39.0                 </span></span>
<span><span class="co">## [35] rmarkdown_2.28              crayon_1.5.3               </span></span>
<span><span class="co">## [37] ragg_1.3.2                  generics_0.1.3             </span></span>
<span><span class="co">## [39] httr_1.4.7                  reshape2_1.4.4             </span></span>
<span><span class="co">## [41] ncdf4_1.23                  DBI_1.2.3                  </span></span>
<span><span class="co">## [43] cachem_1.1.0                rhdf5_2.49.0               </span></span>
<span><span class="co">## [45] stringr_1.5.1               zlibbioc_1.51.1            </span></span>
<span><span class="co">## [47] parallel_4.4.1              AnnotationFilter_1.29.0    </span></span>
<span><span class="co">## [49] BiocManager_1.30.25         XVector_0.45.0             </span></span>
<span><span class="co">## [51] alabaster.schemas_1.5.0     matrixStats_1.3.0          </span></span>
<span><span class="co">## [53] vctrs_0.6.5                 Matrix_1.7-0               </span></span>
<span><span class="co">## [55] jsonlite_1.8.8              bookdown_0.40              </span></span>
<span><span class="co">## [57] IRanges_2.39.2              clue_0.3-65                </span></span>
<span><span class="co">## [59] systemfonts_1.1.0           jquerylib_0.1.4            </span></span>
<span><span class="co">## [61] tidyr_1.3.1                 glue_1.7.0                 </span></span>
<span><span class="co">## [63] pkgdown_2.1.0.9000          codetools_0.2-20           </span></span>
<span><span class="co">## [65] QFeatures_1.15.2            stringi_1.8.4              </span></span>
<span><span class="co">## [67] GenomeInfoDb_1.41.1         GenomicRanges_1.57.1       </span></span>
<span><span class="co">## [69] UCSC.utils_1.1.0            tibble_3.2.1               </span></span>
<span><span class="co">## [71] pillar_1.9.0                htmltools_0.5.8.1          </span></span>
<span><span class="co">## [73] rhdf5filters_1.17.0         GenomeInfoDbData_1.2.12    </span></span>
<span><span class="co">## [75] R6_2.5.1                    textshaping_0.4.0          </span></span>
<span><span class="co">## [77] evaluate_0.24.0             Biobase_2.65.1             </span></span>
<span><span class="co">## [79] lattice_0.22-6              bslib_0.8.0                </span></span>
<span><span class="co">## [81] MetaboCoreUtils_1.13.0      Rcpp_1.0.13                </span></span>
<span><span class="co">## [83] SparseArray_1.5.31          xfun_0.47                  </span></span>
<span><span class="co">## [85] MsCoreUtils_1.17.1          fs_1.6.4                   </span></span>
<span><span class="co">## [87] MatrixGenerics_1.17.0       pkgconfig_2.0.3</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
